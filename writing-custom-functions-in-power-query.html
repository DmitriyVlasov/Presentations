<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Presentation</title>
    <meta name="description" content="">
    <meta name="author" content="unkown">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="//code.jquery.com/jquery-1.8.0.js"></script>
    <script src="//code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/night.css" id="theme">
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/style.css" />
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/deedle.css" />
    <link type="text/css" rel="stylesheet" href="css/custom.css" />
    <script src="fsharp.formatting/styles/tips.js" type="text/javascript"></script>
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <link rel="stylesheet" href="css/fsreveal.css">
    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
    </script>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
    <script language="javascript" type="text/javascript">
        function init()
        {
            websocket = new WebSocket("ws://"+window.location.host+"/websocket");
            websocket.onmessage = function(evt) { location.reload(); };
        }
        window.addEventListener("load", init, false);
    </script>
</head>
<body>
    <div class="reveal">
        
        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section >
<section author="Dmitriy Vlasov" description="Разработка пользовательских функций в Power Query (Черновик)" theme="night" title="Writing Custom Functions in Power Query" transition="default">
<h2>Разработка пользовательских функций в Power Query</h2>
<p><a href="http://DmitriyVlasov.ru">Дмитрий Власов</a>,</p>
<p>Ведущий ERP разработчик в Awara IT Solutions</p>
<p>Первая встреча <a href="https://www.pbiusergroup.com/communities/community-home?CommunityKey=f6f83caa-78fb-4a11-92fb-522457064f77">группы пользователей Microsoft Power BI в Санкт-Петербурге</a></p>
<p>23 августа 2017</p>
</section>
<section >
<h2>Содержание</h2>
<ol>
<li>Зачем писать свои функции?</li>
<li>Основные компоненты языка Power Query</li>
<li>Базовая библиотека языка Power Query</li>
<li>Средства разработки</li>
<li>Ссылки на источники и дополнительные материалы</li>
</ol>
<aside class="notes">
Рекомендации по плану от Максима Зеленского:<br/>
+ 1. М - язык функциональный (почти всё на встроенных функциях).<br/>
+ 2. Имена, выражения, типы<br/>
+ 3. Функция - выражение, тип данных, и отличие от типа результата вычисленной функции.<br/>
4. Когда нужны функции. <br/>
5. Встроенные итераторы и each keyword<br/>
6. Передача аргументов между вложенными функциями<br/>
7. Примеры inline функций и именованных функций.<br/>
</aside>
</section>
</section>
<section >
<h2>Зачем писать свои функции?</h2>
<ul>
<li>Повторное использование вашего кода</li>
<li>Уменьшение избыточности кода</li>
<li>Повышение согласованности вашего кода</li>
</ul>
</section>
<section >
<section >
<h2>Основные компоненты языка Power Query</h2>
<ul>
<li>Обзор</li>
<li>Базовые типы данных</li>
<li>Синтаксис</li>
</ul>
</section>
<section >
<h3>Обзор</h3>
<h4>Формула языка</h4>
<p>Язык программирования Power Query:</p>
<ul>
<li><strong><a href="https://ru.wikipedia.org/wiki/Чистота_языка_программирования">Pure</a></strong> - чистый,</li>
<li><strong><a href="https://ru.wikipedia.org/wiki/Динамическая_типизация">Dynamically typed</a></strong> - динамически типизированный,</li>
<li><strong><a href="https://ru.wikipedia.org/wiki/Функция_высшего_порядка">Higer-order</a></strong> - поддерживает функции высшего порядка,</li>
<li><strong><a href="https://ru.wikipedia.org/wiki/Ленивые_вычисления">Partially lazy</a></strong> - частично ленивый,</li>
<li><strong><a href="https://ru.wikipedia.org/wiki/Функциональное_программирование">Functional</a></strong> - функциональный.</li>
</ul>
<aside class="notes">
Чистый - означает, Побочные эффекты отсутствуют.<br/>
Динамически типизированный - означает, что типы выражений определяются в момент исполнения.<br/>
Функции высшего порядка - это функции использующие в качестве параметра другие функции. Подобные ситуации мы будем встречать далее на каждом шагу при работе с языком Power Query.<br/>
Ленивый - означает, что вычисления происходят так поздно на сколько это возможно. Ленивость языка программирования позволяет делать такие вещи как бесконечные списки, а значит как следствие например удобно поддерживать подключения к базам данных и сервисам по требованию. Или делать сложные вычисления только в тот момент когда это понадобиться.<br/>
Функциональный - означает, что процесс вычисления трактуется как вычисление значений функций в математическом понимании последних.<br/>
Язык чувствительным к регистру символов `BookName` и `bookName` это два разные имени.<br/>
</aside>
</section>
<section >
<h3>Обзор</h3>
<h4>Определение основных элементов языка</h4>
<ul>
<li><strong>Идентификатор</strong> <em>(Identifier)</em> это имя.</li>
<li><strong>Выражение</strong> <em>(Expression)</em> это формула вычисления. Выражения имеют имя.</li>
<li><strong>Значение</strong> <em>(Value)</em>  это результат вычисления выражения. Значение имеет тип.</li>
<li><strong>Тип</strong> <em>(Type)</em> это особый вид значения. Тип может содержать метаданные.</li>
<li><strong>Функция</strong> <em>(Function)</em> это особый вид значения. Обеспечивает основу стандартной библиотеки и позволяет создавать собственные функции.</li>
<li><strong>Запрос</strong> Вычисляет выражения и возвращает значение.</li>
</ul>
<aside class="notes">
Метаданные это просто запись дополнительной информации, которую прикреплять к значению и извлекать из значения.<br/>
Например письмо. Содержимое письма это значение, а отправитель, получатель, индекс получателя это метаданные.<br/>
</aside>
</section>
<section >
<h3>Обзор</h3>
<h4>Примеры основных элементов языка</h4>
<ul>
<li>Безымянное значение</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">42
</code></pre></td></tr></table>
<ul>
<li>Именованное значение</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">А = 42
</code></pre></td></tr></table>
<ul>
<li>Именованное выражение с формулой, при вычислении возвращающее значение</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">B = 6 * 7
</code></pre></td></tr></table>
</section>
<section >
<h3>Обзор</h3>
<h4>Примеры основных элементов языка</h4>
<ul>
<li>Безымянная функция</li>
</ul>
<aside class="notes">
Или как говорят анонимная функция.<br/>
</aside>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">(x) =&gt; x * 1.18
</code></pre></td></tr></table>
<ul>
<li>Именованная функция это выражение с формулой при вычислении возвращающее значение - функцию</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">sumVat = (x) =&gt; x * 1.18
</code></pre></td></tr></table>
<ul>
<li>Именованное значение с прикрепленными метаданными</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">Vat = 1.18 meta [Description = "Базовая ставка налога в РФ в 2017 году."]
</code></pre></td></tr></table>
</section>
<section >
<h3>Базовые типы данных</h3>
<h4>Примитивные типы данных</h4>
<table>
<thead>
<tr class="header">
<th><p>Тип</p></th>
<th><p>Пример</p></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>logical</p></td>
<td><p><code>true</code></p></td>
<td><p><code>false</code></p></td>
</tr>
<tr class="even">
<td><p>text</p></td>
<td><p><code>"Hello"</code></p></td>
<td><p><code>"Привет"</code></p></td>
</tr>
<tr class="odd">
<td><p>number</p></td>
<td><p><code>-42</code></p></td>
<td><p><code>3.14</code></p></td>
</tr>
</tbody>
</table>

</section>
<section >
<h3>Базовые типы данных</h3>
<h4>Типы даты времени</h4>
<table>
<thead>
<tr class="header">
<th><p>Тип</p></th>
<th><p>Пример</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>time</p></td>
<td><p><code>#time(21,35,00)</code></p></td>
</tr>
<tr class="even">
<td><p>date</p></td>
<td><p><code>#date(2017,08,23)</code></p></td>
</tr>
<tr class="odd">
<td><p>datetime</p></td>
<td><p><code>#datetime(2017,08,23 21,35,00)</code></p></td>
</tr>
<tr class="even">
<td><p>datetimezone</p></td>
<td><p><code>#datetimetzone(2017,08,23 21,35,00 09,00)</code></p></td>
</tr>
<tr class="odd">
<td><p>duration</p></td>
<td><p><code>#duration(0,1,30,0)</code></p></td>
</tr>
</tbody>
</table>

<aside class="notes">
Обратите внимание, что в примерах фактически происходит создание значений с помощью встроенных в язык функций начинающих свое имя с решетки.<br/>
</aside>
</section>
<section >
<h3>Базовые типы данных</h3>
<h4>Структуры данных</h4>
<table>
<thead>
<tr class="header">
<th><p>Тип</p></th>
<th><p>Пример</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>list</p></td>
<td><p><code>{1, 2, 3}</code></p></td>
</tr>
<tr class="even">
<td><p>record</p></td>
<td><p><code>[FirstName = "Олег", LastName = "Попов"]</code></p></td>
</tr>
<tr class="odd">
<td><p>table</p></td>
<td><p><code>#table( { "Группа", "Резус" }, { {1, "+"}, {2, "-"} } )</code></p></td>
</tr>
</tbody>
</table>

<aside class="notes">
Power Query поддерживает три базовые структуры данных это списки (list), записи (record) и таблицы (table). Таблицы это списки содержащие в качестве значения записи.<br/>
</aside>
</section>
<section >
<h3>Базовые типы данных</h3>
<h4>Особые типы данных</h4>
<table>
<thead>
<tr class="header">
<th><p>Тип</p></th>
<th><p>Пример</p></th>
<th><p>Примечание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>null</p></td>
<td><p><code>null</code></p></td>
<td><p>Отсутствие значения.</p></td>
</tr>
<tr class="even">
<td><p>any</p></td>
<td></td>
<td><p>Любой тип данных.</p></td>
</tr>
<tr class="odd">
<td><p>anynonnull</p></td>
<td><p>Любой тип данных, значение должно быть.</p></td>
<td></td>
</tr>
<tr class="even">
<td><p>binary</p></td>
<td><p><code>#binary("AQID")</code></p></td>
<td><p>Двоичные данные.</p></td>
</tr>
<tr class="odd">
<td><p>function</p></td>
<td><p><code>(x) =&gt; x * 1.18</code></p></td>
<td><p>Функциональный тип данных.</p></td>
</tr>
<tr class="even">
<td><p>type</p></td>
<td><p><code>type { number }</code></p></td>
<td><p>Тип данных описывающий тип ;-).</p></td>
</tr>
</tbody>
</table>

</section>
<section >
<h3>Базовые структуры данных</h3>
<h4>Список</h4>
<ul>
<li>Список простых значений</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">{ 1, 2, 3 } // Список из трех значений
</code></pre></td></tr></table>
<ul>
<li>Перечисление</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">{1,3,5..10} // Значения 1,3 и от 5 до 10 включительно.
</code></pre></td></tr></table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">{ "а" .. "я" } // Алфавит: а, б, в, г .. я.
</code></pre></td></tr></table>
<ul>
<li>Смешанный список</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">{ true, 42, 3.14, "Привет" } // Значения истина, числа и строка
</code></pre></td></tr></table>
<aside class="notes">
Список это упорядоченная последовательность значений. Нумерация начинается от нуля.<br/>
В следствие ленивости языка в Power Query можно создавать списки бесконечные списки.<br/>
Перечень значений списка заключена в фигурные скобки.<br/>
Список может содержать в своем перечне значения любых типов.<br/>
</aside>
</section>
<section >
<h3>Базовые структуры данных</h3>
<h4>Запись</h4>
<ul>
<li>Простая запись</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq"> [ Йоулупукки = "Финляндия", Дед Мороз = "Россия" ]
</code></pre></td></tr></table>
<ul>
<li>Запись содержащая поля отдельными значениями и списком</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq"> [ Йоулупукки = "Финляндия",
   Дед Мороз = "Россия" ,
   Санта Клаус = {"Германия", "США", "Канада"},
  #"Одзи-сан" = "Япония" 
 ]
</code></pre></td></tr></table>
<aside class="notes">
Запись это не упорядоченный набор полей.<br/>
Каждое поле имеет пару имя и значение.<br/>
Имя должно быть уникальным внутри записи.<br/>
Запись может содержать поля со значениями любых типов.<br/>
Обратите внимание как записано имя деда мороза в Японии.<br/>
Пришлось указать так называемую литеральную форму записи.<br/>
Запись позволяет иметь простые имена, содержащие пробелы в качестве идентификатора, но если появляются другие символы их нужно записывать в специальной форме. <br/>
</aside>
<aside class="notes">
Оставить на будущее: <br/>
 getHoliday = (SantaName, record) => <br/>
   SantaName & " символ нового года в стране " & <br/>
   Record.Field(record, SantaName) & "." ]<br/>
</aside>
</section>
<section >
<h3>Базовые структуры данных</h3>
<h4>Таблица</h4>
<ul>
<li>Символы нового года в разных странах</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">  #table( 
    {"Имя", "Страна"}
    {
      {"Дед мороз", "Россия"}
      {"Санта-Клаус", "США"}
      {"Санта-Клаус", "Германия"}
      {"Санта-Клаус", "Канада"}
      {"Одзи-сан", "Япония"}
    }
  )
</code></pre></td></tr></table>
<aside class="notes">
Таблица это множество значений собранных столбцы и строки.<br/>
Самая простая базовая функция создающая таблицу из первый параметр список заголовков, второй список строк.<br/>
В базовой библиотеке есть ряд удобных функций по созданию списков. <br/>
</aside>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Комментарии</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">/*Многострочные комментарии*/

// Однострочный комментарий
</code></pre></td></tr></table>
<aside class="notes">
Вложенные комментарии не поддерживаются.<br/>
</aside>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Простейшие выражения</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">42 // Значение
</code></pre></td></tr></table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">6 * 7 // Произведение двух чисел
</code></pre></td></tr></table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">#date // простейшая функция создания даты
</code></pre></td></tr></table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">#date(2017,08,23) // Значение даты
</code></pre></td></tr></table>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Выражение let</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let           // Обязательное ключевое слово.
    A = 1,    // Далее с новой строки одно
    B = 2,    // или несколько выражений
    C = A + B // разделенных запятыми.
in            // Обязательное ключевое слово.
  C           // Возвращаемый результат, вычисляется перед возвратом.
</code></pre></td></tr></table>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Вложенное выражение let</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let
  countBox =
    let
        A = 1,
        B = 2,
        C = A + B
    in
      C,
  Result = countBox * 4
in 
  Result
</code></pre></td></tr></table>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Имена выражений</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let
  // Имя выражения только на английском языке без пробелов:
  NumberValue = 42,

  // Имя выражения в форме человеко-читаемого предложения 
  // на любом языке любой длины:
  #"Ответ на главный вопрос жизни, вселенной и всего такого" = NumberValue,

in
  #"Ответ на главный вопрос жизни, вселенной и всего такого"

</code></pre></td></tr></table>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Условное выражение</h4>
<aside class="notes">
Например, давайте напишем выражение требующее принятие решения:<br/>
Если ткущий ответ 42 то следующего ответа ждать бесконечно долго, а иначе ответа не будет.<br/>
Обратите внимание, условное выражение написано без скобок.<br/>
Так как if then else это тоже выражение то обе ветки then и else обязательные.<br/>
</aside>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let 
  #"Ответ на главный вопрос жизни, вселенной и всего такого" = 42,
  currentAnswer = 10,

  nextAnswerDelay = 
    if currentAnswer = 42
    then #infinity // Бесконечность
    else null      // Пусто
in
  nextAnswerDelay
</code></pre></td></tr></table>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Условное выражение</h4>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let
  currentAnswer = 10,
  nextAnswerDelay = 
    if currentAnswer = 42 or 
       currentAnswer = 0 or
       currentAnswer = null
    then #infinity
    else null

in
  nextAnswerDelay
</code></pre></td></tr></table>
<aside class="notes">
В общем случае, если вы описываете в условии несколько последовательных условий, то скобки ставить не нужно,<br/>
Но если вы явно хотите, можете указать скобками приоритет вычисления тех или иных условий.<br/>
Особенно если идет комбинация or и and в одном условии if.  <br/>
</aside>
</section>
<section >
<h3>Синтаксис</h3>
<h4>Пример функции</h4>
<aside class="notes">
Более интересной возможностью будет возможность повторно использовать созданное выражение.<br/>
Давайте обернем его в функцию и вернем для повторного использования.<br/>
</aside>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="pq">let 
  #"Ответ на главный вопрос жизни, вселенной и всего такого" = 42,
  getNextAnswerDelay = (currentAnswer) =&gt; 
    if currentAnswer = #"Ответ на главный вопрос жизни, вселенной и всего такого"
    then #infinity
    else null
in
  getNextAnswerDelay
</code></pre></td></tr></table>
</section>
</section>
<section >
<section >
<h2>Базовая библиотека языка Power Query</h2>
<ul>
<li>Функции доступа к данным</li>
<li>Функции работы с базовыми типами данных</li>
<li>Функции работы с базовыми структурами данных</li>
<li>Функции работы с метаданными</li>
<li>Функции обработки исключений и побочных эффектов</li>
<li>Вспомогательные функции</li>
</ul>
</section>
<section >
<h3>Функции доступа к данным</h3>
</section>
<section >
<h3>Функции работы с базовыми типами данных</h3>
<ul>
<li>Number</li>
<li>Logical</li>
<li>Text</li>
<li>Time</li>
<li>Date</li>
<li>DateTime</li>
<li>DateTimeZone</li>
<li>Duration</li>
<li>Binary</li>
</ul>
</section>
<section >
<h3>Функции работы с базовыми структурами данных</h3>
<ul>
<li>List</li>
<li>Record</li>
<li>Table</li>
</ul>
</section>
<section >
<h3>Функции работы с метаданными</h3>
<ul>
<li>Value</li>
<li>Type</li>
<li>Expression</li>
<li>Function values</li>
</ul>
</section>
<section >
<h3>Функции обработки исключений и побочных эффектов</h3>
<ul>
<li>Action</li>
<li>Error handling</li>
</ul>
</section>
<section >
<h3>Вспомогательные функции</h3>
<ul>
<li>Combiner</li>
<li>Comparer</li>
<li>Replacer</li>
<li>Splitter</li>
<li>Uri</li>
</ul>
</section>
<section >
<h3>Метаданные</h3>
<ul>
<li><code>#sections</code> - Возвращает в записи имена и типы возвращаемого значения для всех запросов из текущего документа Power BI.</li>
<li><code>#shared</code> - Возвращает в записи все имена запросы, функции и типы из текущего документа Power BI.</li>
</ul>
</section>
</section>
<section >
<section >
<h2>Средства разработки</h2>
<ul>
<li>Для пользователя</li>
<li>Расширенные редакторы</li>
<li>Для разработчика</li>
</ul>
</section>
<section >
<h3>Для пользователя</h3>
<ul>
<li><a href="https://powerbi.microsoft.com/ru-ru/desktop/">Power Bi Desktop</a></li>
<li>Excel 2013, Надстройка <a href="https://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D39379">Power Query</a></li>
<li>Excel 2016, <em>(Закладка "Данные" блок "Скачать и преобразовать")</em></li>
</ul>
</section>
<section >
<h3>Расширенные редакторы</h3>
<ul>
<li><a href="https://code.visualstudio.com/">Visual Studio Code</a></li>
<li><a href="https://notepad-plus-plus.org/">Notepad++</a></li>
</ul>
</section>
<section >
<h3>Для разработчика</h3>
<ul>
<li><a href="https://www.visualstudio.com/ru/downloads/">Visual Studio 2017</a></li>
<li>Расширение <a href="https://marketplace.visualstudio.com/items?itemName=Dakahn.PowerQuerySDK">Power Query SDK</a></li>
</ul>
</section>
</section>
<section >
<section >
<h2>Ссылки на источники и дополнительные материалы</h2>
<ul>
<li>Язык</li>
<li>Базовая библиотека языка</li>
<li>Статьи об отдельных аспектах использования языка</li>
</ul>
</section>
<section >
<h3>Язык</h3>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/mt807488.aspx">Спецификация языка Power Query</a> <em>(en)</em></li>
</ul>
</section>
<section >
<h3>Базовая библиотека языка</h3>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/mt779182.aspx">Power Query M function reference</a> <em>(en)</em></li>
<li>Ключевое слово <code>#shared</code> возвращает в записи информацию о используемых запросах, базовых функциях языка и типах из текущего документа Power BI.</li>
</ul>
</section>
<section >
<h3>Статьи об отдельных аспектах использования языка</h3>
<ul>
<li><a href="https://support.office.com/ru-ru/article/%D0%9D%D0%B0%D1%87%D0%B0%D0%BB%D0%BE-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D1%81-Power-Query-7104fbee-9e62-4cb9-a02e-5bfb1a6c536a">Начало работы с Power Query</a> <em>(ru)</em></li>
<li><a href="https://habrahabr.ru/post/311600/">Power Query: как перестать бояться функционального программирования и начать работать в расширенном редакторе запросов</a> <em>(ru)</em></li>
<li><a href="https://habrahabr.ru/company/microsoft/blog/264645/">Power BI. Получаем данные из REST API</a> <em>(ru)</em></li>
<li><a href="https://blog.crossjoin.co.uk/category/power-query/">Блог Криса Вебба</a> <em>(en)</em></li>
<li><a href="https://github.com/Microsoft/DataConnectors/tree/master/docs">Лучшие практики написания функций функций Power Query</a> <em>(en)</em></li>
</ul>
</section>
</section>


        </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>
        // Add the nohighlight class and data-noescape attribute to code elements that have already been formatted by FSharp.Formatting
        $('pre.highlighted code').addClass('nohighlight').attr('data-noescape', '');

        // Full list of configuration options available here:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

            transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

            // Parallax scrolling
            // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
            // parallaxBackgroundSize: '2100px 900px',

            // Optional libraries used to extend on reveal.js
            dependencies: [
                { src: 'lib/js/classList.js', condition: function () { return !document.body.classList; } },
                { src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
                { src: 'plugin/zoom-js/zoom.js', async: true, condition: function () { return !!document.body.classList; } },
                { src: 'plugin/notes/notes.js', async: true, condition: function () { return !!document.body.classList; } }
            ]
        });

    </script>
</body>
</html>

